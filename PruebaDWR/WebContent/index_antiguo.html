<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<meta charset="UTF-8">
<title>Prueba de DWR</title>

<script type='text/javascript' src='/PruebaDWR/dwr/engine.js'></script>
<script type='text/javascript' src='/PruebaDWR/dwr/interface/JRecurso.js'></script>
<script type='text/javascript' src='/PruebaDWR/dwr/util.js'></script>

<script language="javascript">

        function busquedaSQL(ev){
        	if((ev.keyCode>=48 && ev.keyCode<=57) || (ev.keyCode>=65 && ev.keyCode<=90)){
	        	
        		var texto = document.getElementById("texto").value;
	        	
	        	if(texto.length>=3){
	        		JRecurso.sqlBuscadorRecursos(texto, buscar);
	            }
        	}
        }
        
        function buscar(sql){
        	JRecurso.recursosBuscar(0, sql, generarTabla);	
        }
        
        function generarTabla (array){
        	
        	dwr.util.removeAllRows("tabla_encabezado"); 
        	dwr.util.removeAllRows("tabla_cuerpo"); 
        	
        	if(array.length > 0){
        		
        		// Encabezado:
            	var arrayEncabezado = ["encabezado"];
            	var funcEncabezado = [
            	                 function(data) { return "ID Recurso"; },
            	                 function(data) { return "Descripci√≥n"; }
            	               ];
            	dwr.util.addRows("tabla_encabezado", arrayEncabezado, funcEncabezado);
            	
            	// Cuerpo:
            	var funcCasillas = [
            	                 function(data) { return data.idRecurso; },
            	                 function(data) { return data.descripcion; }
            	               ];
            	dwr.util.addRows("tabla_cuerpo", array, funcCasillas);
        	}
        	
        	
        	
        	
 /*       	var tabla = document.getElementById("tabla");
        	dwr.util.removeAllRows("tabla");
 
        	// Encabezado:
			var filaEnc = document.createElement("tr");
			
			var casillaEnc = document.createElement("th");
			var textoEnc = document.createTextNode("ID Recurso");
			casillaEnc.appendChild(textoEnc);
			filaEnc.appendChild(casillaEnc);
			
			var casillaEnc2 = document.createElement("th");
			var textoEnc2 = document.createTextNode("Descripcion");
			casillaEnc2.appendChild(textoEnc2);
			filaEnc.appendChild(casillaEnc2);
			
			tabla.appendChild(filaEnc);
        	
			// Resto de filas:
        	for(var i=0; i<array.length; i++){

    			var fila = document.createElement("tr");
    			
    			var casilla = document.createElement("td");
    			var texto = document.createTextNode(array[i].idRecurso);
    			casilla.appendChild(texto);
    			fila.appendChild(casilla);
    			
    			var casilla2 = document.createElement("td");
    			var texto2 = document.createTextNode(array[i].descripcion);
    			casilla2.appendChild(texto2);
    			fila.appendChild(casilla2);
    			
    			tabla.appendChild(fila);
    		}
*/
        }

    </script>
</head>
<body>
	<center>
		Introduzca recurso:<input type="text" id="texto"
			onkeyup="busquedaSQL(event)" style="width: 300px">
		
		
		<table id="tabla">
			<thead id="tabla_encabezado">
			</thead>
			<tbody id="tabla_cuerpo"> 
			</tbody>
		</table>
	</center>
</body>
</html>
