DROP TABLE Prestamos IF EXISTS;;
DROP TABLE Libros IF EXISTS;;
DROP TABLE Socios IF EXISTS;;

CREATE TABLE Libros(
  IdLibro INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
  Nombre VARCHAR(100) NOT NULL,
  Autor VARCHAR(100) NOT NULL,
  Tema VARCHAR(100) NOT NULL,
  --PRIMARY KEY(IdLibro),
  Unique(Nombre)
);;

CREATE TABLE Socios(
  IdSocio INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
  DNI VARCHAR(15) NOT NULL,
  Apellidos VARCHAR(100) NOT NULL,
  Nombre VARCHAR(50) NOT NULL,
  Direccion VARCHAR(255) NOT NULL,
  FechaAlta DATE DEFAULT CURRENT_DATE NOT NULL,
  --PRIMARY KEY(IdSocio),
  Unique(DNI)
);;

CREATE TABLE Prestamos(
  IdPrestamo INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
  IdSocio INT NOT NULL,
  IdLibro INT NOT NULL,
  FechaInicio DATE NOT NULL,
  FechaFin DATE NOT NULL,
  --PRIMARY KEY(IdPrestamo),
  Unique(IdSocio,IdLibro,FechaInicio),
  FOREIGN KEY(IdSocio) REFERENCES Socios(IdSocio),
  FOREIGN KEY(IdLibro) REFERENCES Libros(IdLibro)
);;
